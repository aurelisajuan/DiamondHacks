chrome.runtime.onInstalled.addListener(()=>{console.log("ClearLock extension installed"),chrome.storage.local.set({settings:{notifications:!0,autoScan:!0,aiSuggestions:!0,privacyLevel:80,scanInterval:"always"}})});chrome.action.onClicked.addListener(()=>{chrome.runtime.openOptionsPage()});chrome.tabs.onUpdated.addListener((e,t,i)=>{t.status==="complete"&&i.url&&chrome.storage.local.get(["settings"],a=>{const o=a.settings||{};if(o.autoScan){console.log(`Analyzing website: ${i.url}`);const n=["low","medium","high"],s=n[Math.floor(Math.random()*n.length)];s!=="low"&&o.notifications&&chrome.tabs.sendMessage(e,{action:"showNotification",riskLevel:s,title:s==="high"?"High Risk Detected!":"Privacy Warning",message:s==="high"?"This website shows signs of a potential scam. Be careful with your personal information.":"This website is requesting unnecessary permissions. Click to review."})}})});chrome.runtime.onMessage.addListener((e,t,i)=>{if(e.action==="scanWebsite")return console.log("Scanning website for privacy concerns"),setTimeout(()=>{i({success:!0,riskLevel:Math.random()>.5?"high":"medium",issues:["Excessive permissions","Tracking cookies"]})},1e3),!0;e.action==="openOptions"&&chrome.runtime.openOptionsPage(),e.action==="pageAnalysisComplete"&&(console.log("Page analysis complete:",e),chrome.storage.local.set({[`site_${e.url}`]:{title:e.title,permissions:e.permissions,lastScanned:new Date().toISOString()}}))});
